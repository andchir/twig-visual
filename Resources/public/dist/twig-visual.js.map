{"version":3,"sources":["../src/index.js"],"names":[],"mappings":"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","file":"twig-visual.js","sourcesContent":["\nclass TwigVisual {\n\n    constructor(options) {\n        this.data = {};\n        this.options = Object.assign({\n            uiOptions: {\n                field: {\n                    components: []\n                },\n                photogallery: {\n                    components: []\n                },\n                menu: {\n                    components: []\n                },\n                breadcrumbs: {\n                    components: []\n                },\n                \"shopping-cart\": {\n                    components: [\n                        {\n                            name: \"totalPrice\", title: \"Общая цена\", xpath: \"\"\n                        },\n                        {\n                            name: \"totalCount\", title: \"Общее количество\", xpath: \"\"\n                        },\n                        {\n                            name: \"lickCheckout\", title: \"Ссылка на оформление\", xpath: \"\"\n                        },\n                        {\n                            name: \"buttonClean\", title: \"Кнопка очистки\", xpath: \"\"\n                        }\n                    ]\n                },\n                \"products-list\": {\n                    components: []\n                },\n                comments: {\n                    components: []\n                }\n            }\n        }, options);\n        this.container = this.createContainer();\n        this.state = 'inactive';\n\n        this.listenerOnMouseOver = this.onMouseOver.bind(this);\n        this.listenerOnMouseOut = this.onMouseOut.bind(this);\n        this.listenerOnMouseWheel = this.onMouseWheel.bind(this);\n        this.listenerOnMouseClick = this.onSelectedElementClick.bind(this);\n        this.currentElements = [];\n\n        this.init();\n    }\n\n    static onReady(cb) {\n        if (document.readyState !== 'loading') {\n            cb();\n        } else {\n            document.addEventListener('DOMContentLoaded', cb);\n        }\n    };\n\n    init() {\n\n        // Start button\n        const buttonStart = this.container.querySelector('.twv-button-start-select');\n        buttonStart.addEventListener('click', (e) => {\n            e.preventDefault();\n            this.selectModeToggle();\n        });\n        \n        buttonStart.parentNode.querySelector('.twv-block-active-status-button-cancel').addEventListener('click', (e) => {\n            e.preventDefault();\n            this.selectionCancel();\n        });\n    }\n\n    selectModeToggle() {\n        if (this.state === 'inactive') {\n            this.container.style.display = 'none';\n            document.addEventListener('mouseover', this.listenerOnMouseOver);\n            document.addEventListener('mouseout', this.listenerOnMouseOut);\n            document.addEventListener('wheel', this.listenerOnMouseWheel, {passive: false});\n            document.addEventListener('click', this.listenerOnMouseClick);\n            this.state = 'active';\n        } else {\n            this.container.style.display = 'block';\n            document.removeEventListener('mouseover', this.listenerOnMouseOver);\n            document.removeEventListener('mouseout', this.listenerOnMouseOut);\n            document.removeEventListener('wheel', this.listenerOnMouseWheel);\n            document.removeEventListener('click', this.listenerOnMouseClick);\n            this.state = 'inactive';\n        }\n    }\n\n    onMouseOver(e) {\n        if (this.getXPathForElement(e.target).indexOf('twig-visual-container') > -1) {\n            return;\n        }\n        this.currentElements = [];\n        this.updateXPathInfo(e.target);\n        e.target.classList.add('twv-selected');\n    }\n\n    onMouseOut(e) {\n        if (this.getXPathForElement(e.target).indexOf('twig-visual-container') > -1) {\n            return;\n        }\n        this.currentElements = [];\n        const elements = Array.from(document.querySelectorAll('.twv-selected'));\n        elements.forEach((element) => {\n            element.classList.remove('twv-selected');\n        });\n    }\n\n    onSelectedElementClick(e) {\n        if (this.getXPathForElement(e.target).indexOf('twig-visual-container') > -1) {\n            return;\n        }\n        e.preventDefault();\n\n        this.selectModeToggle();\n        \n        let currentElement = this.currentElements.length > 0\n            ? this.currentElements[this.currentElements.length - 1]\n            : e.target;\n        this.selectionCancel(currentElement);\n        \n        const xpath = this.getXPathForElement(currentElement);\n        this.createSelectionOptions(xpath);\n    }\n    \n    selectionCancel(currentElement = null) {\n        if (!currentElement && this.currentElements.length > 0) {\n            currentElement = this.currentElements[this.currentElements.length - 1];\n        }\n        this.data = {};\n        this.currentElements = [];\n        currentElement && currentElement.classList.remove('twv-selected');\n\n        this.state = 'inactive';\n        const buttonStart = this.container.querySelector('.twv-button-start-select');\n        if (document.querySelector('.twv-info')) {\n            this.removeEl(document.querySelector('.twv-info'));\n        }\n        buttonStart.parentNode.classList.remove('twv-block-active-status-active');\n        this.container.querySelector('.twv-inner').innerHTML = '';\n\n        if (document.querySelector('.twv-back-overlay')) {\n            this.removeEl(document.querySelector('.twv-back-overlay'));\n        }\n        if (document.querySelector('.twv-selected-element')) {\n            document.querySelector('.twv-selected-element').classList.remove('twv-selected-element');\n        }\n    }\n\n    onMouseWheel(e) {\n        if (this.getXPathForElement(e.target).indexOf('twig-visual-container') > -1) {\n            return;\n        }\n        e.preventDefault();\n        let currentElement = this.currentElements.length > 0\n            ? this.currentElements[this.currentElements.length - 1]\n            : e.target;\n        if (e.deltaY < 0) {\n            currentElement.classList.remove('twv-selected');\n            this.currentElements.push(currentElement.parentNode);\n            \n            this.updateXPathInfo(currentElement.parentNode);\n            currentElement.parentNode.classList.add('twv-selected');\n        } else {\n            currentElement.classList.remove('twv-selected');\n            this.currentElements.splice(this.currentElements.length - 1, 1);\n            currentElement = this.currentElements.length > 0\n                ? this.currentElements[this.currentElements.length - 1]\n                : e.target;\n\n            this.updateXPathInfo(currentElement);\n            currentElement.classList.add('twv-selected');\n        }\n    }\n\n    updateXPathInfo(element) {\n        const xpath = this.getXPathForElement(element);\n        if (xpath.indexOf('twig-visual-container') > -1) {\n            return;\n        }\n        let div = document.querySelector('.twv-info');\n        if (!div) {\n            div = document.createElement('div');\n            div.className = 'twv-info small';\n            document.body.appendChild(div);\n        }\n        div.style.display = 'block';\n        div.innerHTML = `<div>${xpath}</div>`;\n    }\n\n    getXPathForElement(element) {\n        if (element.id !== '')\n            return 'id(\"' + element.id + '\")';\n        if (element.tagName === 'HTML')\n            return ('/HTML[1]').toLowerCase();\n        if (element === document.body)\n            return ('/HTML[1]/BODY[1]').toLowerCase();\n\n        let ix = 0;\n        const siblings = element.parentNode.childNodes;\n        for (let i = 0; i < siblings.length; i++) {\n            const sibling = siblings[i];\n            if (sibling === element) {\n                return this.getXPathForElement(element.parentNode) + '/'\n                    + element.tagName.toLowerCase() + '[' + (ix + 1) + ']'\n                    + this.getXpathElementAttributes(element);\n            }\n            if (sibling.nodeType === 1 && sibling.tagName === element.tagName)\n                ix++;\n        }\n    }\n\n    getXpathElementAttributes(element) {\n        if (element.hasAttribute('id')) {\n            return `id(\"${element.id}\")`;\n        } else if(element.hasAttribute('class') && element.getAttribute('class')) {\n            return `[@class=\"${element.getAttribute('class')}\"]`;\n        }\n        return  '';\n    }\n\n    getElementByXPath(xpath) {\n        return document.evaluate(xpath, document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;\n    }\n\n    createContainer() {\n        const containerEl = document.createElement('div');\n        containerEl.id = 'twig-visual-container';\n        containerEl.className = 'twig-visual-container twv-panel-right';\n        containerEl.innerHTML = `\n<div class=\"twv-panel-header\">\n    <button class=\"twv-btn twv-btn-sm twv-mr-1 twv-button-panel-left\" type=\"button\" title=\"Передвинуть влево\">\n        <i class=\"twv-icon-arrow_back\"></i>\n    </button>\n    <button class=\"twv-btn twv-btn-sm twv-button-panel-right\" type=\"button\" title=\"Передвинуть вправо\">\n        <i class=\"twv-icon-arrow_forward\"></i>\n    </button>\n</div>\n<div class=\"twv-block-active-status twv-mb-3\">\n    <button type=\"button\" class=\"twv-btn twv-btn-primary twv-btn-block twv-mb-3 twv-block-active-status-inactive-content twv-button-start-select\">\n        <i class=\"twv-icon-center_focus_strong\"></i>\n        Выбрать элемент\n    </button>\n    <div class=\"twv-block-active-status-active-content\">\n        <div class=\"twv-input-group\">\n            <span class=\"twv-input-group-text twv-flex-fill\" title=\"Элемент интерфейса\">\n                <i class=\"twv-icon-done twv-mr-2 twv-text-success\"></i>\n                Выбрано\n            </span>\n            <div class=\"twv-input-group-append\">\n                <button class=\"twv-btn twv-block-active-status-button-cancel\" title=\"Отменить\">\n                    <i class=\"twv-icon-clearclose\"></i>\n                </button>\n            </div>\n        </div>\n    </div>\n</div>\n<div class=\"twv-inner\"></div>\n`;\n        document.body.appendChild(containerEl);\n        \n        containerEl.querySelector('.twv-button-panel-left').addEventListener('click', (e) => {\n            e.preventDefault();\n            this.panelMove('left');\n        });\n\n        containerEl.querySelector('.twv-button-panel-right').addEventListener('click', (e) => {\n            e.preventDefault();\n            this.panelMove('right');\n        });\n        \n        return containerEl;\n    }\n\n    panelMove(direction) {\n        const newClassName = `twv-panel-${direction}`;\n        if (this.container.classList.contains(newClassName)) {\n            this.container.classList.add('twv-panel-hidden');\n            return;\n        } else if (this.container.classList.contains('twv-panel-hidden')) {\n            this.container.classList.remove('twv-panel-hidden');\n            return;\n        }\n        this.container.classList.remove('twv-panel-' + (direction === 'left' ? 'right' : 'left'));\n        this.container.classList.add(newClassName);\n    }\n\n    createSelectionOptions(xpath) {\n        const elementSelected = this.getElementByXPath(xpath);\n        if (!elementSelected) {\n            throw new Error('Element for XPath not found.');\n        }\n\n        const buttonStart = this.container.querySelector('.twv-button-start-select');\n        buttonStart.parentNode.classList.add('twv-block-active-status-active');\n\n        this.container.querySelector('.twv-inner').innerHTML = '';\n\n        const xpathEscaped = xpath.replace(/[\\\"]/g, '&quot;');\n        const div = document.createElement('div');\n        div.innerHTML = `\n<b>XPath:</b>\n<div class=\"twv-p-1 twv-mb-3 twv-small twv-bg-gray\">\n    <div class=\"twv-text-overflow\" title=\"${xpathEscaped}\">${xpath}</div>\n</div>\n<div class=\"twv-mb-3 twv-ui-element-select\">\n    <select class=\"twv-select\">\n        <option value=\"\">- Тип блока интерфейса -</option>\n        <option value=\"field\">Поле контента</option>\n        <option value=\"photogallery\">Фото-галерея</option>\n        <option value=\"menu\">Меню</option>\n        <option value=\"breadcrumbs\">Хлебные кношки</option>\n        <option value=\"shopping-cart\">Корзина товаров</option>\n        <option value=\"products-list\">Избранные товары</option>\n        <option value=\"comments\">Отзывы</option>\n    </select>\n</div>\n<div class=\"twv-ui-components\"></div>\n        `;\n        this.container.querySelector('.twv-inner').appendChild(div);\n\n        const componentsContainer = this.container.querySelector('.twv-ui-components');\n\n        this.container.querySelector('.twv-ui-element-select').addEventListener('change', (e) => {\n            componentsContainer.innerHTML = '';\n            if (!this.options.uiOptions[e.target.value]) {\n                return;\n            }\n\n            const opt = this.options.uiOptions[e.target.value];\n            opt.components.forEach((cmp) => {\n                \n                const div = document.createElement('div');\n                div.className = 'twv-mb-2';\n                div.innerHTML = `\n                <button class=\"twv-btn twv-btn-block\">${cmp.title}</button>\n                `;\n                \n                componentsContainer.appendChild(div);\n            });\n\n            console.log(e.target.value, this.options.uiOptions[e.target.value]);\n\n        });\n\n        const compStyles = window.getComputedStyle(elementSelected);\n        const position = compStyles.getPropertyValue('position');\n        const backgroundColor = compStyles.getPropertyValue('background-color');\n        if (position === 'static') {\n            elementSelected.style.position = 'relative';\n        }\n        if (['rgba(0, 0, 0, 0)', 'transparent'].indexOf(backgroundColor) > -1) {\n            // elementSelected.style.backgroundColor = '#fff';\n        }\n        const backgroundOverlay = document.createElement('div');\n        backgroundOverlay.className = 'twv-back-overlay';\n        document.body.appendChild(backgroundOverlay);\n        \n        elementSelected.classList.add('twv-selected-element');\n\n        console.log(xpath, backgroundColor, elementSelected, position);\n\n    }\n\n    removeEl(el) {\n        el.parentNode.removeChild(el);\n    };\n}\n\nlet twigVisual;\n\nTwigVisual.onReady(() => {\n    twigVisual = new TwigVisual();\n});\n"]}