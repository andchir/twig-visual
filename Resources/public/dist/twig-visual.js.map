{"version":3,"sources":["../src/index.js"],"names":[],"mappings":"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","file":"twig-visual.js","sourcesContent":["\nclass TwigVisual {\n\n    constructor(options) {\n        this.options = Object.assign({\n            uiOptions: {\n                field: {\n                    components: []\n                },\n                photogallery: {\n                    components: []\n                },\n                menu: {\n                    components: []\n                },\n                breadcrumbs: {\n                    components: []\n                },\n                \"shopping-cart\": {\n                    components: [\n                        {\n                            name: \"totalPrice\", title: \"Общая цена\", xpath: \"\"\n                        },\n                        {\n                            name: \"totalCount\", title: \"Общее количество\", xpath: \"\"\n                        },\n                        {\n                            name: \"lickCheckout\", title: \"Ссылка на оформление\", xpath: \"\"\n                        },\n                        {\n                            name: \"buttonClean\", title: \"Кнопка очистки\", xpath: \"\"\n                        }\n                    ]\n                },\n                \"products-list\": {\n                    components: []\n                },\n                comments: {\n                    components: []\n                }\n            }\n        }, options);\n        this.container = this.createContainer();\n        this.state = 'inactive';\n\n        this.listenerOnMouseOver = this.onMouseOver.bind(this);\n        this.listenerOnMouseOut = this.onMouseOut.bind(this);\n        this.listenerOnMouseWheel = this.onMouseWheel.bind(this);\n        this.listenerOnMouseClick = this.onSelectedElementClick.bind(this);\n        this.currentElements = [];\n\n        this.init();\n    }\n\n    static onReady(cb) {\n        if (document.readyState !== 'loading') {\n            cb();\n        } else {\n            document.addEventListener('DOMContentLoaded', cb);\n        }\n    };\n\n    init() {\n\n        // Start button\n        const buttonStart = this.container.querySelector('.twv-button-start-select');\n        buttonStart.addEventListener('click', (e) => {\n            e.preventDefault();\n            this.selectModeToggle();\n        });\n    }\n\n    selectModeToggle() {\n        if (this.state === 'inactive') {\n            this.container.style.display = 'none';\n            document.addEventListener('mouseover', this.listenerOnMouseOver);\n            document.addEventListener('mouseout', this.listenerOnMouseOut);\n            document.addEventListener('wheel', this.listenerOnMouseWheel, {passive: false});\n            document.addEventListener('click', this.listenerOnMouseClick);\n            this.state = 'active';\n        } else {\n            this.container.style.display = 'block';\n            document.removeEventListener('mouseover', this.listenerOnMouseOver);\n            document.removeEventListener('mouseout', this.listenerOnMouseOut);\n            document.removeEventListener('wheel', this.listenerOnMouseWheel);\n            document.removeEventListener('click', this.listenerOnMouseClick);\n            this.state = 'inactive';\n        }\n    }\n\n    onMouseOver(e) {\n        if (e.target.classList.contains('twig-visual-container')\n            || (e.target.parentNode.classList && e.target.parentNode.classList.contains('twig-visual-container'))) {\n            return;\n        }\n        this.currentElements = [];\n        this.updateXPathInfo(e.target);\n        e.target.classList.add('twv-selected');\n    }\n\n    onMouseOut(e) {\n        if (e.target.classList.contains('twig-visual-container')\n            || (e.target.parentNode.classList && e.target.parentNode.classList.contains('twig-visual-container'))) {\n            return;\n        }\n        this.currentElements = [];\n        const elements = Array.from(document.querySelectorAll('.twv-selected'));\n        elements.forEach((element) => {\n            element.classList.remove('twv-selected');\n        });\n    }\n\n    onSelectedElementClick(e) {\n        if (e.target.classList.contains('twig-visual-container')\n            || e.target.parentNode.classList.contains('twig-visual-container')) {\n            return;\n        }\n        e.preventDefault();\n        let currentElement = this.currentElements.length > 0\n            ? this.currentElements[this.currentElements.length - 1]\n            : e.target;\n        this.currentElements = [];\n        currentElement.classList.remove('twv-selected');\n\n        if (document.querySelector('.twv-info')) {\n            this.removeEl(document.querySelector('.twv-info'));\n        }\n        const xpath = this.getXPathForElement(currentElement);\n        this.createSelectionOptions(xpath);\n\n        this.selectModeToggle();\n    }\n\n    onMouseWheel(e) {\n        if (e.target.classList.contains('twig-visual-container')\n            || e.target.parentNode.classList.contains('twig-visual-container')) {\n            return;\n        }\n        e.preventDefault();\n        let currentElement = this.currentElements.length > 0\n            ? this.currentElements[this.currentElements.length - 1]\n            : e.target;\n        if (e.deltaY < 0) {\n            currentElement.classList.remove('twv-selected');\n            this.currentElements.push(currentElement.parentNode);\n\n            this.updateXPathInfo(currentElement.parentNode);\n\n            currentElement.parentNode.classList.add('twv-selected');\n        } else {\n            currentElement.classList.remove('twv-selected');\n            this.currentElements.splice(this.currentElements.length - 1, 1);\n            currentElement = this.currentElements.length > 0\n                ? this.currentElements[this.currentElements.length - 1]\n                : e.target;\n\n            this.updateXPathInfo(currentElement);\n\n            currentElement.classList.add('twv-selected');\n        }\n    }\n\n    updateXPathInfo(element) {\n        let div = document.querySelector('.twv-info');\n        if (!div) {\n            div = document.createElement('div');\n            div.className = 'twv-info small';\n            document.body.appendChild(div);\n        }\n        div.style.display = 'block';\n        div.innerHTML = '<div>' + this.getXPathForElement(element) + '</div>';\n    }\n\n    getXPathForElement(element) {\n        if (element.id !== '')\n            return 'id(\"' + element.id + '\")';\n        if (element.tagName === 'HTML')\n            return ('/HTML[1]').toLowerCase();\n        if (element === document.body)\n            return ('/HTML[1]/BODY[1]').toLowerCase();\n\n        let ix = 0;\n        const siblings = element.parentNode.childNodes;\n        for (let i = 0; i < siblings.length; i++) {\n            const sibling = siblings[i];\n            if (sibling === element) {\n                return this.getXPathForElement(element.parentNode) + '/'\n                    + element.tagName.toLowerCase() + '[' + (ix + 1) + ']'\n                    + this.getXpathElementAttributes(element);\n            }\n            if (sibling.nodeType === 1 && sibling.tagName === element.tagName)\n                ix++;\n        }\n    }\n\n    getXpathElementAttributes(element) {\n        if (element.hasAttribute('id')) {\n            return `id(\"${element.id}\")`;\n        } else if(element.hasAttribute('class') && element.getAttribute('class')) {\n            return `[@class=\"${element.getAttribute('class')}\"]`;\n        }\n        return  '';\n    }\n\n    getElementByXPath(xpath) {\n        return document.evaluate(xpath, document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;\n    }\n\n    createContainer() {\n        const containerEl = document.createElement('div');\n        containerEl.id = 'twig-visual-container';\n        containerEl.className = 'twig-visual-container';\n        containerEl.innerHTML = `\n<button type=\"button\" class=\"twv-btn twv-btn-block twv-mb-3 twv-button-start-select\">Select</button>\n<div class=\"twv-inner\"></div>\n`;\n        document.body.appendChild(containerEl);\n        return containerEl;\n    }\n\n    createSelectionOptions(xpath) {\n        const elementSelected = this.getElementByXPath(xpath);\n        if (!elementSelected) {\n            throw new Error('Element for XPath not found.');\n        }\n\n        this.container.querySelector('.twv-inner').innerHTML = '';\n\n        const xpathEscaped = xpath.replace(/[\\\"]/g, '&quot;');\n        const div = document.createElement('div');\n        div.innerHTML = `<div class=\"twv-mb-3 twv-ui-element-select\">\n        <select class=\"twv-select\">\n        <option value=\"\">- Элемент интерфейса -</option>\n        <option value=\"field\">Поле контента</option>\n        <option value=\"photogallery\">Фото-галерея</option>\n        <option value=\"menu\">Меню</option>\n        <option value=\"breadcrumbs\">Хлебные кношки</option>\n        <option value=\"shopping-cart\">Корзина товаров</option>\n        <option value=\"products-list\">Избранные товары</option>\n        <option value=\"comments\">Отзывы</option>\n</select>\n</div>\n<b>XPath:</b>\n<div class=\"twv-p-1 twv-mb-3 twv-small twv-bg-gray\">\n    <div class=\"twv-text-overflow\" title=\"${xpathEscaped}\">${xpath}</div>\n</div>\n<div class=\"twv-ui-components\"></div>\n        `;\n        this.container.querySelector('.twv-inner').appendChild(div);\n\n        const componentsContainer = this.container.querySelector('.twv-ui-components');\n\n        this.container.querySelector('.twv-ui-element-select').addEventListener('change', (e) => {\n            componentsContainer.innerHTML = '';\n            if (!this.options.uiOptions[e.target.value]) {\n                return;\n            }\n\n            const opt = this.options.uiOptions[e.target.value];\n            opt.components.forEach((cmp) => {\n\n                const button = document.createElement('button');\n                button.type = 'button';\n                button.className = 'twv-btn twv-mb-2';\n                button.textContent = cmp.title;\n\n                componentsContainer.appendChild(button);\n            });\n\n            console.log(e.target.value, this.options.uiOptions[e.target.value]);\n\n        });\n\n        const compStyles = window.getComputedStyle(elementSelected);\n        const position = compStyles.getPropertyValue('position');\n\n        console.log(xpath, elementSelected, position);\n\n    }\n\n    removeEl(el) {\n        el.parentNode.removeChild(el);\n    };\n}\n\nlet twigVisual;\n\nTwigVisual.onReady(() => {\n    twigVisual = new TwigVisual();\n});\n"]}